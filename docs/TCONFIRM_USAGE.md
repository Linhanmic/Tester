# tconfirm 命令使用说明

## 概述

`tconfirm` 是一个人机交互指令，用于在测试执行过程中让用户手动判断测试结果是否符合预期。当执行到此命令时，会弹出一个确认对话框，用户可以根据实际观察到的现象选择"通过"或"失败"。

## 语法

```
tconfirm 提示信息
```

## 参数说明

- **提示信息**: 向用户显示的提示文本，描述需要确认的内容或需要观察的现象

## 使用场景

`tconfirm` 命令适用于以下场景：

1. **物理现象确认**: 需要用户观察硬件设备的物理状态（如LED指示灯、电机运转、声音等）
2. **主观判断**: 需要人工判断的测试结果（如显示效果、响应速度等）
3. **外部设备状态**: 需要确认连接的外部设备的状态变化
4. **安全确认**: 在执行危险操作前需要人工确认
5. **调试辅助**: 在开发调试阶段，需要手动介入判断的情况

## 执行流程

1. 测试执行到 `tconfirm` 命令时会暂停
2. 弹出模态对话框显示提示信息
3. 用户根据实际情况选择：
   - **通过**: 表示观察到的现象符合预期，测试继续执行
   - **失败**: 表示观察到的现象不符合预期，该测试用例标记为失败
   - **取消/关闭**: 等同于选择"失败"

## 示例

### 示例 1: LED 状态确认

```tester
tstart=LED测试
  // 发送LED控制命令
  tcans 0,0x100,01-00-00-00-00-00-00-00,100,1
  tdelay 500

  // 要求用户确认LED状态
  tconfirm 请确认LED1是否已点亮？

  // 继续后续测试...
tend
```

### 示例 2: 电机启动确认

```tester
tstart=电机测试
  // 发送电机启动命令
  tcans 0,0x200,FF-00-00-00-00-00-00-00,100,1
  tdelay 1000

  // 确认电机是否启动
  tconfirm 请确认电机是否已正常启动并运转？

  // 发送电机停止命令
  tcans 0,0x200,00-00-00-00-00-00-00-00,100,1
  tdelay 500

  // 确认电机是否停止
  tconfirm 请确认电机是否已停止运转？
tend
```

### 示例 3: 综合功能测试

```tester
tstart=系统综合测试
  // 发送系统自检命令
  tcans 0,0x7DF,02-01-00-00-00-00-00-00,100,1
  tdelay 2000

  // 接收自检结果
  tcanr 0,0x7E8,0.0-7.7,print,3000

  // 要求用户综合判断
  tconfirm 请根据打印的自检数据和设备状态，确认系统是否正常？
tend
```

## 注意事项

1. **测试中断**: 执行 `tconfirm` 时测试会完全暂停，包括所有后台发送任务
2. **用户响应**: 用户必须对对话框做出响应，测试才会继续执行
3. **测试结果**: 用户选择"失败"会导致当前测试用例标记为失败，但不会中断整个测试流程
4. **消息清晰**: 提示信息应该清晰、具体，让用户明确知道需要观察什么、确认什么
5. **避免滥用**: 不要过度使用 `tconfirm`，只在确实需要人工判断的地方使用

## 最佳实践

1. **提供上下文**: 在 `tconfirm` 前使用 `tdelay` 给设备足够的响应时间
2. **明确描述**: 提示信息应该明确描述需要观察的现象
3. **组合使用**: 可以与其他命令组合使用，如先打印接收数据，再让用户确认
4. **测试文档**: 在测试用例中用注释说明预期的现象，便于用户判断

## 与其他命令的配合

```tester
tstart=完整测试流程
  // 1. 发送测试命令
  tcans 0,0x300,AA-BB-CC-DD-00-00-00-00,100,5

  // 2. 等待设备响应
  tdelay 1000

  // 3. 接收并打印反馈数据
  tcanr 0,0x301,0.0-7.7,print,2000

  // 4. 让用户综合判断
  tconfirm 请根据接收到的数据和设备表现，判断功能是否正常？

  // 5. 如果用户确认通过，继续后续测试
  tdelay 500
  tcans 0,0x302,00-00-00-00-00-00-00-00,100,1
tend
```

## 输出日志

当执行 `tconfirm` 命令时，输出通道会显示：

```
> tconfirm 请确认LED是否点亮？
  等待用户确认...
  用户确认: 通过
```

或

```
> tconfirm 请确认LED是否点亮？
  等待用户确认...
  用户确认: 失败
```
